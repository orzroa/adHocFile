<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <title>adHocFile</title>
    <style type="text/css">
  html{
    width: 100%;
    height: 100%;
    overflow: hidden;
    font-style: sans-serif;
  }
  body{
    width: 100%;
    height: 100%;
    font-family: 'Open Sans',sans-serif;
    margin: 0;
    background-color: #3399ff;
  }
  .block{
    position: relative;
    top: 30%;
    left:50%;
    margin: -150px 0 0 -150px;
    width: 300px;
    height: 450px;
  }
  .block h1{
    color: #fff;
    text-shadow:0 0 10px;
    letter-spacing: 1px;
    text-align: center;
  }
  h1{
    font-size: 2em;
    margin: 0.67em 0;
  }
  .divide{
    position: relative;
    top: 5%;
    width: 80%;
  }
  input{
    width: 90%;
    height: 10%;
    margin-bottom: 10px;
    outline: none;
    padding: 10px;
    font-size: 13px;
    color: #fff;
    text-shadow:1px 1px 1px;
    border-top: 1px solid #312E3D;
    border-left: 1px solid #312E3D;
    border-right: 1px solid #312E3D;
    border-bottom: 1px solid #56536A;
    border-radius: 4px;
    background-color: #2D2D3F;
  }
  .but{
    width: 80%;
    height: 10%;
    display: block;
    background-color: #4a77d4;
    border: 1px solid #3762bc;
    color: #fff;
    padding: 9px 14px;
    font-size: 15px;
    line-height: normal;
    border-radius: 5px;
    margin: 0;
  }
    </style>
    <script>
      window.addEventListener('load', function() {
        switch(getQueryVariable('result')) {
          case 's': alert('文件传输成功！')
                    break;
          case 'f': alert('文件传输失败！')
                    break;
        }

        var code = '';
        const max=25
        for(var i=0;i<6;i++) {
          code += String.fromCharCode('A'.charCodeAt() + parseInt(Math.random()*(max+1),10));
        }
        document.getElementById('upCode').value = code
        document.getElementById('upTitle').textContent = '上传码：' + code
      })

      function getQueryVariable(variable) {
        var query = window.location.search.substring(1);
        var vars = query.split("&");
        for (var i=0;i<vars.length;i++) {
          var pair = vars[i].split("=");
          if(pair[0] == variable) {return pair[1];}
        }
        return(false);
      }

      function down() {
        const code = document.getElementById('downCode').value
        window.location.href = './down/' + code
      }
    </script>
</head>
<body>
    <div class="block">
        <h1 id="upTitle">上传</h1>
        <form name="formUp" method="post" action="up" enctype="multipart/form-data" >
            <input type="hidden" required="required" placeholder="请输入提取码" id="upCode" name="upCode" readonly/>
            <input type="file" required="required" placeholder="请选择文件" name="file"/>
            <div align="center"><button class="but" type="submit">提交</button></div>
        </form>
    </div>

    <HR class="divide" style="FILTER: alpha(opacity=100,finishopacity=0,style=3)" width="80%" color=#987cb9 SIZE=1>

    <div class="block">
        <h1>下载</h1>
        <form name="formDown" action="javascript:down()">
            <input type="text" required="required" placeholder="请输入提取码" id="downCode" autofocus="autofocus"/>
            <div align="center"><button class="but" type="submit">提交</button></div>
        </form>
    </div>
</body>
</html>